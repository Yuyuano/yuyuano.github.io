# 基于明日方舟的抽卡概率做的抽卡模拟
```
术语表：
| 名词  | 对应机制               |
| --- | ------------------ |
| 硬保底 | 概率固定，第 N 抽必出       |
| 软保底 | 50 抽后每抽 +2%        |
| 天井  | 300 抽可直接兑换当期 UP 六星 |
```
>[!WARNING]
本篇所有代码都没有对输入做判断，请不要输入字符或者空白
>

>[!TIP]  
如果想让脚本更健壮，把 `guess = int(input(...))` 包成：
 ```python
 while True:
     try:
         guess = int(input('请输入 1-100 的整数：'))
         break
     except ValueError:
         print('格式错误，请重新输入！')
 ```
>
## 将会分步骤一步步变难
>[!NOTE]
这玩意对于初学者来说有亿点难以理解，不懂问Ai吧，或者找我
>
### 标准池（6⭐概率2%） 无保底写法
```python
import random
chou = int(input('你想要抽多少发？：')) #自定义想抽多少发
def gacha():     #用def函数方便自定义抽数
    r = random.randint(1, 100)
   # random.randint(1,100) 生成的是 1~100 闭区间，共 100 个整数
    if r <= 2:          # 6⭐ 2/100 = 2%
        return '⭐⭐⭐⭐⭐⭐'
    elif r <= 8:
        return '⭐⭐⭐⭐⭐'
    elif r <= 50:
        return '⭐⭐⭐⭐'
    else:
        return '⭐⭐⭐'
for i in range(chou): #循环输入的次数
    print(gacha()) #执行def函数并输出
```
>[!NOTE]
这个用了**def函数**来自定义抽数，理解不了**def**可以把自定义抽数的代码去掉然后直接`For循环`判断抽卡的内容
>
### （假）保底写法
因为明日方舟保底概率是随着抽数的增长而增长，为了方便理解，这里先介绍**硬保底**（也就是抽到多少抽必出，不随着抽数增加概率）
```python
import random

chou = int(input('你想要抽多少发？：'))

def gacha(pity):
    """返回 (结果, 新pity)"""
    # 硬保底：第99抽必出6⭐
    if pity == 99:
        return '⭐⭐⭐⭐⭐⭐', 0

    # 正常概率
    r = random.randint(1, 100)
    if r <= 2:                # 出6⭐
        return '⭐⭐⭐⭐⭐⭐', 0
    elif r <= 8:
        return '⭐⭐⭐⭐⭐', pity + 1
    elif r <= 50:
        return '⭐⭐⭐⭐', pity + 1
    else:
        return '⭐⭐⭐', pity + 1

pity = 0
for i in range(chou):
    result, pity = gacha(pity)
    print(result)
```
>[!TIP]
要善用计数器来作为额外的计算次数道具
>
### (真）保底写法
```python
import random
chou = int(input('你想要抽多少发？：'))
def gacha(pity):
    """返回 (抽卡结果, 新的pity计数)"""
    # 计算当前 6⭐概率
    six_rate = min(2 + max(0, pity - 49) * 2, 100)   # 第51抽开始+2%  官方：50 抽之后（即第 51 抽）每抽 +2%
    r = random.randint(1, 100) 

    if r <= six_rate:           # 出 6⭐
        return '⭐⭐⭐⭐⭐⭐', 0
    elif r <= 8:                # 5⭐
        return '⭐⭐⭐⭐⭐', pity + 1
    elif r <= 50:               # 4⭐
        return '⭐⭐⭐⭐', pity + 1
    else:                       # 3⭐
        return '⭐⭐⭐', pity + 1

pity = 0                        # 开局垫 0 抽
for i in range(chou):
    result, pity = gacha(pity)  # 抽一次，拿到新 pity
    print(result)
```

### 集大成者完整版（拥有随抽数增加保底概率增加，会歪，有统计功能0）
```python
import random
from collections import Counter

# ========== 参数 ==========
UP_NAME = "影焰·苇草"      # 当期 UP 六星
N = int(input("抽多少发？："))

# ========== 核心抽卡 ==========
def gacha(pity):
    """返回 (结果, 新pity, 是否出六星)"""
    # 软保底：50 抽后每抽 +2%
    six_rate = 2 + max(0, pity - 49) * 2
    six_rate = min(six_rate, 100)

    r = random.randint(1, 100)
    if r <= six_rate:                       # 出六星
        up_or_ng = random.choices(["UP", "歪"], weights=[70, 30])[0]
        return (f"六星·{UP_NAME}" if up_or_ng == "UP" else "六星·常驻"), 0, True
    elif r <= 8:                            # 五星
        return "五星", pity + 1, False
    elif r <= 50:                           # 四星
        return "四星", pity + 1, False
    else:                                   # 三星
        return "三星", pity + 1, False

# ========== 开抽 ==========
pity = 0
record = []
first_6 = None
last_6 = None
six_count = 0
guarantee_300 = False

for i in range(1, N + 1):
    result, pity, is_6 = gacha(pity)
    record.append(result)
    if is_6:
        six_count += 1
        if first_6 is None:
            first_6 = i
        last_6 = i
    if i == 300 and not guarantee_300:
        guarantee_300 = True
        print("\n>>> 已达成 300 抽，可直接兑换当期 UP 六星！（默认帮你兑换了）<<<")
# ========== 天井补发 ==========
c = Counter(record)          # 前面已有的行
if guarantee_300 and c[f'六星·{UP_NAME}'] == 0:
    c[f'六星·{UP_NAME}'] += 1
    six_count += 1
    record.append(f'六星·{UP_NAME}(300抽兑换)')

# ========== 输出 ==========
print("\n===== 抽卡结果 =====")
for idx, res in enumerate(record, 1):
    print(f"{idx:3d} | {res}")

# ========== 统计 ==========
c = Counter(record)
print("\n===== 统计 =====")
for k, v in c.items():
    print(f"{k}: {v} 张")
print(f"\n总计六星: {six_count} 张")
print(f"UP 六星: {c.get(f'六星·{UP_NAME}', 0)} 张")
print(f"歪六星: {c.get('六星·常驻', 0)} 张")
if first_6:
    print(f"最早六星: 第 {first_6} 抽")
    print(f"最晚六星: 第 {last_6} 抽")
else:
    print("本次未出六星")
print(f"当前垫抽数: {pity}")
```
运行结果差不多如下
```txt
===== 抽卡结果 =====
  1 | 三星
  2 | 三星
 ...
 29 | 六星·常驻
 30 | 三星

===== 统计 =====
三星: 25 张
四星: 3 张
五星: 1 张
六星·苇草: 1 张（300井兑换）
六星·常驻: 1 张
总计六星: 1 张
最早六星: 第 29 抽
当前垫抽数: 1
```
说实话，这玩意看的我都头痛（拿AI搞得）😗，没事，只要搞熟了你也行